"use strict";(self.webpackWcGzdBlocksJsonp=self.webpackWcGzdBlocksJsonp||[]).push([[131],{953:function(e,t,c){c.r(t),c.d(t,{default:function(){return g}});var n=c(9196),o=c(9307),a=c(3554),s=c(2819),d=c.n(s),r=c(1984),l=c(7231),i=({show:e,url:t,onClose:c,content:a})=>{const[s,d]=(0,o.useState)(!0),[i,u]=(0,o.useState)("");let h="";if(a)u(a),d(!1);else if(t)try{const e=new URL(t);h=t.toString().substring(e.origin.length)}catch{}return(0,o.useEffect)((()=>{e?document.body.classList.add("checkout-modal-open"):document.body.classList.remove("checkout-modal-open"),h&&(d(!0),u(""),fetch(h,{method:"get"}).then((e=>e.text())).then((e=>{u(e),d(!1)})).catch((function(e){d(!1)})))}),[h,u,e]),e?(0,n.createElement)(n.Fragment,null,(0,n.createElement)("div",{className:"wc-gzd-checkout-modal-bg"}),(0,n.createElement)("div",{className:"wc-gzd-checkout-modal-wrapper"},(0,n.createElement)("div",{className:"wc-gzd-checkout-modal"},(0,n.createElement)("div",{className:"actions"},(0,n.createElement)("a",{className:"wc-gzd-checkout-modal-close",onClick:e=>{document.body.classList.remove("checkout-modal-open"),c(e)}},(0,n.createElement)(r.Z,{className:"wc-gzd-checkout-modal-close-icon",icon:l.Z,size:24}))),s?(0,n.createElement)("div",{className:"content is-loading"},(0,n.createElement)("span",{className:"wc-block-components-spinner","aria-hidden":"true"})):(0,n.createElement)(n.Fragment,null,(0,n.createElement)("div",{className:"content",dangerouslySetInnerHTML:{__html:i}}))))):null},u=c(6342),h=c(9818),m=c(4801),k=c(4617),b=e=>{const{onChangeCheckbox:t,checkbox:c}=e,{shouldCreateAccount:a,customerId:s}=(0,h.useSelect)((e=>{const t=e(m.CHECKOUT_STORE_KEY);return{customerId:t.getCustomerId(),shouldCreateAccount:t.getShouldCreateAccount()}})),d=!1===(0,k.getSetting)("checkoutAllowsGuest",!1)&&!s;return(0,o.useEffect)((()=>{t(a||d?{...c,hidden:!1}:{...c,hidden:!0})}),[a]),(0,n.createElement)(u.Z,{...e})},_=e=>{const[t,c]=(0,o.useState)({}),{onChangeCheckbox:a,checkbox:s}=e,{billingAddress:d,paymentData:r,currentPaymentMethod:l}=(0,h.useSelect)((e=>{const t=e(m.CART_STORE_KEY),c=e(m.PAYMENT_STORE_KEY);return{billingAddress:t.getCartData().billingAddress,paymentData:c.getPaymentMethodData(),currentPaymentMethod:c.getActivePaymentMethod()}}));return(0,o.useEffect)((()=>{const e={country:d.country,postcode:d.postcode,city:d.city,street:d.address_1,address_2:d.address_2,account_holder:r.hasOwnProperty("direct_debit_account_holder")?r.direct_debit_account_holder:"",account_iban:r.hasOwnProperty("direct_debit_account_iban")?r.direct_debit_account_iban:"",account_swift:r.hasOwnProperty("direct_debit_account_bic")?r.direct_debit_account_bic:""};c(e),a("direct-debit"===l&&e.account_holder&&e.account_iban&&e.account_swift?{...s,hidden:!1}:{...s,hidden:!0})}),[d,r,l]),(0,n.createElement)(u.Z,{...e,setModalUrl:c=>{c+="&"+new URLSearchParams(t).toString(),e.setModalUrl(c)}})},g=({children:e,checkoutExtensionData:t,extensions:c,cart:s})=>{const[r,l]=(0,o.useState)(!1),{setExtensionData:h}=t,m=c.hasOwnProperty("woocommerce-germanized")?c["woocommerce-germanized"]:{},k=m.hasOwnProperty("checkboxes")?m.checkboxes:[],g=k.reduce(((e,t)=>({...e,[t.id]:{...t,hidden:t.default_hidden,checked:t.default_checked}})),{}),[E,p]=(0,o.useState)(g),[w,y]=(0,o.useState)(""),f=(0,o.useRef)(!1),C=e=>Object.values(e).filter((e=>e.checked||!e.has_checkbox&&!e.hidden?e:null));(0,o.useEffect)((()=>{h("woocommerce-germanized","checkboxes",C(E))}),[E]);const x=(0,o.useCallback)((e=>{p((t=>{const c=t&&t.hasOwnProperty(e.id)&&t[e.id].checked!==e.checked,n={...t,[e.id]:{...e}};return c&&(0,a.extensionCartUpdate)({namespace:"woocommerce-germanized-checkboxes",data:{checkboxes:C(n)}}),n}))}),[h,E,p,a.extensionCartUpdate]);return(0,o.useEffect)((()=>{if(f.current){let e={};Object.keys(g).map((t=>{const c=E.hasOwnProperty(t)?{checked:E[t].checked,hidden:E[t].hidden}:{};e[t]={...g[t],...c}})),d().isEqual(e,E)||p(e)}f.current=!0}),[k]),(0,n.createElement)("div",{className:"wc-gzd-checkboxes"},(0,n.createElement)(i,{show:r,url:w,onClose:()=>{l(!1)}}),Object.keys(E).map((e=>{const t={...E[e]};return"sepa"===t.id?(0,n.createElement)(_,{checkbox:t,setShowModal:l,setModalUrl:y,key:t.id,onChangeCheckbox:x}):"privacy"===t.id?(0,n.createElement)(b,{checkbox:t,setShowModal:l,setModalUrl:y,key:t.id,onChangeCheckbox:x}):(0,n.createElement)(u.Z,{checkbox:t,setShowModal:l,setModalUrl:y,key:t.id,onChangeCheckbox:x})})))}}}]);